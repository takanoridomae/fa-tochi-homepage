# Google Forms連携セットアップ手順

## 1. Googleフォームの作成

### フォーム項目の設定
以下の順番で質問を作成してください：

1. **姓** (記述式・必須)
2. **名** (記述式・必須)  
3. **メールアドレス** (記述式・必須・メール形式の検証ON)
4. **電話番号** (記述式・任意)
5. **ご希望のサービス** (選択式・任意)
   - 通常洗浄（60%クリーニング）
   - 全分解洗浄（85-95%クリーニング）
   - 背抜洗浄（99%クリーニング）
   - 見積もりのみ
   - その他
6. **住所** (記述式・任意)
7. **エアコン台数** (選択式・任意)
   - 1台
   - 2台
   - 3台
   - 4台
   - 5台以上
8. **ご希望日時** (記述式・任意)
9. **お問い合わせ内容** (段落・必須)

## 2. フォームURLの取得

1. フォーム編集画面で「送信」ボタンをクリック
2. 「リンク」タブを選択
3. 「URLを短縮」のチェックを外す
4. URLをコピー（例：https://docs.google.com/forms/d/e/1FAIpQLSe...../viewform）

## 3. 送信先URLの取得

1. フォームのURLから`viewform`を`formResponse`に変更
2. 例：https://docs.google.com/forms/d/e/1FAIpQLSe...../formResponse

## 4. フィールドIDの取得（最新版対応）

### 方法A: 実際のテスト送信で確認（最も確実）

1. **フォームに実際にデータを入力**
   - 姓: テスト姓
   - 名: テスト名
   - メール: test@example.com
   - 電話: 090-1234-5678
   - サービス: 通常洗浄（60%クリーニング）
   - 住所: 栃木県テスト市
   - エアコン台数: 1台
   - 希望日時: 2024-01-01 10:00
   - 内容: テスト送信です

2. **送信ボタンを押す前に開発者ツールを開く**
   - F12キーを押す
   - 「Network」タブを選択
   - 「Clear」ボタンでログをクリア

3. **フォームを送信**
   - 送信ボタンをクリック

4. **送信データを確認**
   - Networkタブで「formResponse」を探してクリック
   - 「Payload」または「Form Data」セクションを確認
   - `entry.xxxxxxxxx: 値` の形式でフィールドIDが表示される

### 方法B: フォームのHTMLソースから検索

1. **フォームプレビューページでソースを表示**
   - Ctrl+U（Windows）またはCmd+Option+U（Mac）

2. **entry.を検索**
   - Ctrl+F で「entry.」を検索
   - `"entry.xxxxxxxxx"` の形式を探す

3. **data-params属性を確認**
   - 新しいGoogle Formsでは `data-params` 内にentry IDが含まれることがある

### 方法C: 簡易的な順番による推測

Google Formsは通常、フィールドを作成した順番で連続したIDを割り当てます：

```javascript
// 一般的なパターン（フォーム作成順）
const GOOGLE_FORM_FIELDS = {
    lastName: 'entry.1234567890',      // 1番目: 姓
    firstName: 'entry.1234567891',     // 2番目: 名
    email: 'entry.1234567892',         // 3番目: メール
    phone: 'entry.1234567893',         // 4番目: 電話
    serviceType: 'entry.1234567894',   // 5番目: サービス
    address: 'entry.1234567895',       // 6番目: 住所
    airconCount: 'entry.1234567896',   // 7番目: エアコン台数
    preferredDate: 'entry.1234567897', // 8番目: 希望日時
    message: 'entry.1234567898'        // 9番目: お問い合わせ内容
};
```

## 5. スプレッドシートとの連携

1. フォーム編集画面で「回答」タブをクリック
2. スプレッドシートアイコンをクリック
3. 「新しいスプレッドシートを作成」を選択
4. これで回答が自動的にスプレッドシートに保存されます

## 6. 通知設定

1. 作成されたスプレッドシートを開く
2. 「ツール」→「通知ルール」
3. 「フォームが送信されたとき」を選択
4. 通知頻度を「すぐに」に設定
5. これで新しい回答があるとメールで通知されます

## 7. 設定確認用のテストフォーム

実際のフィールドIDを確認するため、以下の手順でテスト送信を行ってください：

1. フォームに適当なデータを入力して送信
2. スプレッドシートで列の順番を確認
3. 各列が正しいフィールドに対応しているか確認

## 8. トラブルシューティング

### name属性が見つからない場合
- 新しいGoogle Formsでは動的にIDが生成される
- 方法Aの「実際のテスト送信」が最も確実
- 送信時のNetworkタブでentry IDを確認

### フィールドIDが分からない場合
- まずテスト送信を行う
- スプレッドシートの列順序を確認
- 順番に基づいてIDを推測 